<!DOCTYPE html>
<html xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
<head>
<meta charset="UTF-8">
<title>Obtenir une réponse au format JSON</title>

<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:_dlc_DocId msdt:dt="string">Z5HNVW24N33T-678105430-3933</mso:_dlc_DocId>
<mso:_dlc_DocIdItemGuid msdt:dt="string">82fc0956-c938-4272-86dc-b29bcf5e424f</mso:_dlc_DocIdItemGuid>
<mso:_dlc_DocIdUrl msdt:dt="string">http://inet/sites/projets/EcoleNumerique/_layouts/15/DocIdRedir.aspx?ID=Z5HNVW24N33T-678105430-3933, Z5HNVW24N33T-678105430-3933</mso:_dlc_DocIdUrl>
<mso:xd_Signature msdt:dt="string"></mso:xd_Signature>
<mso:TemplateUrl msdt:dt="string"></mso:TemplateUrl>
<mso:xd_ProgID msdt:dt="string"></mso:xd_ProgID>
<mso:_dlc_DocIdPersistId msdt:dt="string"></mso:_dlc_DocIdPersistId>
<mso:Order msdt:dt="string">393300.000000000</mso:Order>
<mso:ContentTypeId msdt:dt="string">0x010100486201FEAA9EBE4FA7C434936B46E6EC</mso:ContentTypeId>
<mso:_SourceUrl msdt:dt="string"></mso:_SourceUrl>
<mso:_SharedFileIndex msdt:dt="string"></mso:_SharedFileIndex>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</head>
<body>
	<p>
		Le bouton suivant permet d'obtenir d'effectuer une requête AJAX et d'obtenir une réponse au format JSON.
		La requête pointe vers l'URL /modules/module9/rest/crayons.
	</p>
	<div>
		<input type="button" value="Exécuter" onclick="executerRequete()" />
	</div>
	
	<div id="succes" style="color:green"></div>
	<div id="echec" style="color:red"></div>
	
	<div>
		<a href="demonstration4.html">Retour</a>
	</div>
	
	
	
	<script type="text/javascript">
	function createXHR() {
	    if (window.XMLHttpRequest)    //  Objet standard
	    {
	        xhr = new XMLHttpRequest();     //  Firefox, Safari, ...
	    }
	    else if (window.ActiveXObject)      //  Internet Explorer
	    {
	        xhr = new ActiveXObject("Msxml2.XMLHTTP");
	    }
	    return xhr;
	}

	function executerRequete()
	{
	    var xhr = createXHR();
	    xhr.onreadystatechange = function()
	    {
	        if (xhr.readyState == 4)
	        {
	            if (xhr.status == 200)
	            {
	            	succes(xhr.responseText);//xhr.responseXML si réponse au format XML
	            }
	            else
	            {
	                echec(xhr.status, xhr.responseText);
	            }
	        }
	    };

	    xhr.open("GET", "/AppliDemo/modules/module9/rest/crayons", true);
	    xhr.setRequestHeader("Accept","application/json");
	    xhr.send(null);
	}	
	
	function succes(reponse)
	{
		document.getElementById("succes").innerHTML=reponse;
		document.getElementById("echec").innerHTML="";
	}
	
	function echec(codeReponse, reponse)
	{
		document.getElementById("echec").innerHTML=reponse;
		document.getElementById("succes").innerHTML="";
	}
	
	</script>
</body>
</html>